<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Crypto.PublicKey.RSA</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="Crypto-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.pycrypto.org/">PyCrypto.org</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="Crypto-module.html">Package&nbsp;Crypto</a> ::
        <a href="Crypto.PublicKey-module.html">Package&nbsp;PublicKey</a> ::
        Module&nbsp;RSA
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="Crypto.PublicKey.RSA-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module RSA</h1><p class="nomargin-top"></p>
<p>RSA public-key cryptography algorithm (signature and encryption).</p>
<p><a class="rst-reference external" href="http://en.wikipedia.org/wiki/RSA_%28algorithm%29" target="_top">RSA</a> is the most widespread and used public key algorithm. Its security is
based on the difficulty of factoring large integers. The algorithm has
withstood attacks for 30 years, and it is therefore considered reasonably
secure for new designs.</p>
<p>The algorithm can be used for both confidentiality (encryption) and
authentication (digital signature). It is worth noting that signing and
decryption are significantly slower than verification and encryption.
The cryptograhic strength is primarily linked to the length of the modulus <em>n</em>.
In 2012, a sufficient length is deemed to be 2048 bits. For more information,
see the most recent <a class="rst-reference external" href="http://www.ecrypt.eu.org/documents/D.SPA.17.pdf" target="_top">ECRYPT</a> report.</p>
<p>Both RSA ciphertext and RSA signature are as big as the modulus <em>n</em> (256
bytes if <em>n</em> is 2048 bit long).</p>
<p>This module provides facilities for generating fresh, new RSA keys, constructing
them from known components, exporting them, and importing them.</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> Crypto.PublicKey <span class="py-keyword">import</span> RSA
<span class="py-prompt">&gt;&gt;&gt;</span>
<span class="py-prompt">&gt;&gt;&gt; </span>key = RSA.generate(2048)
<span class="py-prompt">&gt;&gt;&gt; </span>f = open(<span class="py-string">'mykey.pem'</span>,<span class="py-string">'w'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>f.write(RSA.exportKey(<span class="py-string">'PEM'</span>))
<span class="py-prompt">&gt;&gt;&gt; </span>f.close()
<span class="py-more">...</span>
<span class="py-prompt">&gt;&gt;&gt; </span>f = open(<span class="py-string">'mykey.pem'</span>,<span class="py-string">'r'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>key = RSA.importKey(f.read())</pre>
</blockquote>
<p>Even though you may choose to  directly use the methods of an RSA key object
to perform the primitive cryptographic operations (e.g. <a href="Crypto.PublicKey.RSA._RSAobj-class.html#encrypt" class="link">_RSAobj.encrypt</a>),
it is recommended to use one of the standardized schemes instead (like
<a href="Crypto.Cipher.PKCS1_v1_5-module.html" class="link">Crypto.Cipher.PKCS1_v1_5</a> or <a href="Crypto.Signature.PKCS1_v1_5-module.html" class="link">Crypto.Signature.PKCS1_v1_5</a>).</p>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Classes</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="Crypto.PublicKey.RSA.error-class.html" class="summary-name">error</a>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="Crypto.PublicKey.RSA._RSAobj-class.html" class="summary-name">_RSAobj</a><br />
      Class defining an actual RSA key.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="Crypto.PublicKey.RSA.RSAImplementation-class.html" class="summary-name">RSAImplementation</a><br />
      An RSA key factory.
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Functions</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.PublicKey.RSA-module.html#generate" class="summary-sig-name">generate</a>(<span class="summary-sig-arg">bits</span>,
        <span class="summary-sig-arg">randfunc</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">progress_func</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">e</span>=<span class="summary-sig-default">65537</span>)</span><br />
      Randomly generate a fresh, new RSA key object.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.PublicKey.RSA-module.html#construct" class="summary-sig-name">construct</a>(<span class="summary-sig-arg">tup</span>)</span><br />
      Construct an RSA key object from a tuple of valid RSA components.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.PublicKey.RSA-module.html#importKey" class="summary-sig-name">importKey</a>(<span class="summary-sig-arg">externKey</span>,
        <span class="summary-sig-arg">passphrase</span>=<span class="summary-sig-default">None</span>)</span><br />
      Import an RSA key (public or private half), encoded in standard form.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Function Details</span></td>
</tr>
</table>
<a name="generate"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">generate</span>(<span class="sig-arg">bits</span>,
        <span class="sig-arg">randfunc</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">progress_func</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">e</span>=<span class="sig-default">65537</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Randomly generate a fresh, new RSA key object.</p>
<p>See <a href="Crypto.PublicKey.RSA.RSAImplementation-class.html#generate" class="link">RSAImplementation.generate</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>bits</code></strong> (int) - Key length, or size (in bits) of the RSA modulus.
It must be a multiple of 256, and no smaller than 1024.</li>
        <li><strong class="pname"><code>randfunc</code></strong> (callable) - Random number generation function; it should accept
a single integer N and return a string of random data
N bytes long.
If not specified, a new one will be instantiated
from <tt class="rst-docutils literal">Crypto.Random</tt>.</li>
        <li><strong class="pname"><code>progress_func</code></strong> (callable) - Optional function that will be called with a short string
containing the key parameter currently being generated;
it's useful for interactive applications where a user is
waiting for a key to be generated.</li>
        <li><strong class="pname"><code>e</code></strong> (int) - Public RSA exponent. It must be an odd positive integer.
It is typically a small number with very few ones in its
binary representation.
The default value 65537 (= <tt class="rst-docutils literal">0b10000000000000001</tt> ) is a safe
choice: other common values are 5, 7, 17, and 257.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>An RSA key object (<a href="Crypto.PublicKey.RSA._RSAobj-class.html" class="link">_RSAobj</a>).</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>ValueError</strong></code> - When <strong>bits</strong> is too little or not a multiple of 256, or when
<strong>e</strong> is not odd or smaller than 2.</li>
    </ul></dd>
  </dl>
<div class="fields">      <strong>Attention:</strong>
      <ul class="nomargin-top">
        <li>
        You should always use a cryptographically secure random number generator,
such as the one defined in the <tt class="rst-docutils literal">Crypto.Random</tt> module; <strong>don't</strong> just use the
current time and the <tt class="rst-docutils literal">random</tt> module.
        </li>
        <li>
        Exponent 3 is also widely used, but it requires very special care when padding
the message.
        </li>
      </ul>
</div></td></tr></table>
</div>
<a name="construct"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">construct</span>(<span class="sig-arg">tup</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Construct an RSA key object from a tuple of valid RSA components.</p>
<p>See <a href="Crypto.PublicKey.RSA.RSAImplementation-class.html#construct" class="link">RSAImplementation.construct</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><p><strong class="pname"><code>tup</code></strong> (tuple) - A tuple of long integers, with at least 2 and no
more than 6 items. The items come in the following order:</p>
<ol class="rst-arabic simple">
<li>RSA modulus (n).</li>
<li>Public exponent (e).</li>
<li>Private exponent (d). Only required if the key is private.</li>
<li>First factor of n (p). Optional.</li>
<li>Second factor of n (q). Optional.</li>
<li>CRT coefficient, (1/p) mod q (u). Optional.</li>
</ol></li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>An RSA key object (<a href="Crypto.PublicKey.RSA._RSAobj-class.html" class="link">_RSAobj</a>).</dd>
  </dl>
</td></tr></table>
</div>
<a name="importKey"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">importKey</span>(<span class="sig-arg">externKey</span>,
        <span class="sig-arg">passphrase</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Import an RSA key (public or private half), encoded in standard form.</p>
<p>See <a href="Crypto.PublicKey.RSA.RSAImplementation-class.html#importKey" class="link">RSAImplementation.importKey</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><p><strong class="pname"><code>externKey</code></strong> (string) - The RSA key to import, encoded as a string.</p>
<p>An RSA public key can be in any of the following formats:</p>
<ul class="rst-simple">
<li>X.509 <code class="link">subjectPublicKeyInfo</code> DER SEQUENCE (binary or PEM encoding)</li>
<li><a class="rst-reference external" href="http://www.ietf.org/rfc/rfc3447.txt" target="_top">PKCS#1</a> <code class="link">RSAPublicKey</code> DER SEQUENCE (binary or PEM encoding)</li>
<li>OpenSSH (textual public key only)</li>
</ul>
<p>An RSA private key can be in any of the following formats:</p>
<ul class="rst-simple">
<li>PKCS#1 <code class="link">RSAPrivateKey</code> DER SEQUENCE (binary or PEM encoding)</li>
<li><a class="rst-reference external" href="http://www.ietf.org/rfc/rfc5208.txt" target="_top">PKCS#8</a> <code class="link">PrivateKeyInfo</code> DER SEQUENCE (binary or PEM encoding)</li>
<li>OpenSSH (textual public key only)</li>
</ul>
<p>For details about the PEM encoding, see <a class="rst-reference external" href="http://www.ietf.org/rfc/rfc1421.txt" target="_top">RFC1421</a>/<a class="rst-reference external" href="http://www.ietf.org/rfc/rfc1423.txt" target="_top">RFC1423</a>.</p>
<p>In case of PEM encoding, the private key can be encrypted with DES or 3TDES according to a certain <tt class="rst-docutils literal">pass phrase</tt>.
Only OpenSSL-compatible pass phrases are supported.</p></li>
        <li><strong class="pname"><code>passphrase</code></strong> (string) - In case of an encrypted PEM key, this is the pass phrase from which the encryption key is derived.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>An RSA key object (<a href="Crypto.PublicKey.RSA._RSAobj-class.html" class="link">_RSAobj</a>).</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>ValueError/IndexError/TypeError</strong></code> - When the given key cannot be parsed (possibly because the pass phrase is wrong).</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="Crypto-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.pycrypto.org/">PyCrypto.org</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Thu May 24 09:02:36 2012
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
