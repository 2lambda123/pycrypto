<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [pycrypto] How can I read a standard openssl private key	with	PyCrypto and decrypt with it?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:pycrypto%40lists.dlitz.net?Subject=%5Bpycrypto%5D%20How%20can%20I%20read%20a%20standard%20openssl%20private%20key%0A%09with%09PyCrypto%20and%20decrypt%20with%20it%3F&In-Reply-To=f08ddf990908181807h37eccfc9n59b84e096885b29c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000111.html">
   <LINK REL="Next"  HREF="000113.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[pycrypto] How can I read a standard openssl private key	with	PyCrypto and decrypt with it?</H1>
    <B>Dwayne C. Litzenberger</B> 
    <A HREF="mailto:pycrypto%40lists.dlitz.net?Subject=%5Bpycrypto%5D%20How%20can%20I%20read%20a%20standard%20openssl%20private%20key%0A%09with%09PyCrypto%20and%20decrypt%20with%20it%3F&In-Reply-To=f08ddf990908181807h37eccfc9n59b84e096885b29c%40mail.gmail.com"
       TITLE="[pycrypto] How can I read a standard openssl private key	with	PyCrypto and decrypt with it?">dlitz at dlitz.net
       </A><BR>
    <I>Tue Aug 18 21:26:30 CST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000111.html">[pycrypto] How can I read a standard openssl private key with	PyCrypto and decrypt with it?
</A></li>
        <LI>Next message: <A HREF="000113.html">[pycrypto] How can I read a standard openssl private key with	PyCrypto and decrypt with it?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#112">[ date ]</a>
              <a href="thread.html#112">[ thread ]</a>
              <a href="subject.html#112">[ subject ]</a>
              <a href="author.html#112">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Aug 18, 2009 at 06:07:53PM -0700, William Heath wrote:
&gt;<i>I generated a private key with:
</I>&gt;<i>
</I>&gt;<i>   openssl.exe req -x509 -nodes -days 365 -newkey rsa:1024 -keyout
</I>&gt;<i>sdgidfedapp11.corp.intuit.net.key -out sdgidfedapp11.corp.intuit.net.crt
</I>&gt;<i>
</I>&gt;<i>I can't figure out is how to use PyCrypto.RSA.construct with it
</I>&gt;<i>to decrypt something.
</I>[snip]
&gt;<i>I am sure there is a way to do this with PyCrypto, anyone know how to do it?
</I>
I am not aware of any simple way to do what you ask without using a 
separate library.  PKCS#1 and X.509 are not implemented in PyCrypto, and as 
far as I understand, you would need both to do anything useful with such a 
key.

At this time, PyCrypto's API for RSA is somewhat confusing: It only 
implements textbook RSA, so it's not really useful for anyone except other 
crypto library developers (e.g. Paramiko, Twisted, etc.).  You might be 
able to use OpenSSL to generate hex values for each of the parameters, then 
parse the results and feed them to RSA.construct yourself using something 
like this:

     openssl rsa -text -in sdgidfedapp11.corp.intuit.net.key

However, since PyCrypto lacks PKCS#1 support, if you aren't careful or if 
you don't know exactly what you are doing, you will probably expose your 
private key to compromise.

If you want to do practical public-key work with X.509 today, you might 
want to check out other libraries like pycryptopp, Google Key Czar, and 
M2Crypto.  Also, Paramiko (which depends on PyCrypto) might support at 
least reading those files, since IIRC they're also used for SSH private 
keys.

Please do remember that PyCrypto's current RSA functions are insecure if 
used directly.  I would like to introduce a simple public key API at some 
point, but right now it doesn't exist.

If you're doing any low-level work with RSA, you should at minimum, read 
and understand this overview paper:

     <A HREF="http://www.cs.bgu.ac.il/~beimel/Courses/crypto/Boneh.pdf">http://www.cs.bgu.ac.il/~beimel/Courses/crypto/Boneh.pdf</A>

Also, as a side note, 1024-bit RSA keys are a little on the short side 
today.  I would recommend nothing less than 2048 bits:

     <A HREF="http://www.google.com/search?q=1024-bit+RSA">http://www.google.com/search?q=1024-bit+RSA</A>

Hope that helps.

Cheers,
- Dwayne

--
Dwayne C. Litzenberger &lt;<A HREF="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">dlitz at dlitz.net</A>&gt;
  Key-signing key   - 19E1 1FE8 B3CF F273 ED17  4A24 928C EC13 39C2 5CF7
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000111.html">[pycrypto] How can I read a standard openssl private key with	PyCrypto and decrypt with it?
</A></li>
	<LI>Next message: <A HREF="000113.html">[pycrypto] How can I read a standard openssl private key with	PyCrypto and decrypt with it?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#112">[ date ]</a>
              <a href="thread.html#112">[ thread ]</a>
              <a href="subject.html#112">[ subject ]</a>
              <a href="author.html#112">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">More information about the pycrypto
mailing list</a><br>
</body></html>
