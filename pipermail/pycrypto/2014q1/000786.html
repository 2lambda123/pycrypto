<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [pycrypto] Got different PKCS1_v1_5 signature result on the same message &amp; same rsa key pair
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:pycrypto%40lists.dlitz.net?Subject=Re%3A%20%5Bpycrypto%5D%20Got%20different%20PKCS1_v1_5%20signature%20result%20on%20the%0A%20same%20message%20%26%20same%20rsa%20key%20pair&In-Reply-To=%3CCAGfyce3FDy%3Dor1eOMmdSnePurU3qs%2BBH3F1EqU_Fodn83GNFZg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000785.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[pycrypto] Got different PKCS1_v1_5 signature result on the same message &amp; same rsa key pair</H1>
    <B>Legrandin</B> 
    <A HREF="mailto:pycrypto%40lists.dlitz.net?Subject=Re%3A%20%5Bpycrypto%5D%20Got%20different%20PKCS1_v1_5%20signature%20result%20on%20the%0A%20same%20message%20%26%20same%20rsa%20key%20pair&In-Reply-To=%3CCAGfyce3FDy%3Dor1eOMmdSnePurU3qs%2BBH3F1EqU_Fodn83GNFZg%40mail.gmail.com%3E"
       TITLE="[pycrypto] Got different PKCS1_v1_5 signature result on the same message &amp; same rsa key pair">helderijs at gmail.com
       </A><BR>
    <I>Wed Mar 12 03:47:15 PDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000785.html">[pycrypto] Got different PKCS1_v1_5 signature result on the same message &amp; same rsa key pair
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#786">[ date ]</a>
              <a href="thread.html#786">[ thread ]</a>
              <a href="subject.html#786">[ subject ]</a>
              <a href="author.html#786">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>PKCS#1v1.5 happens to be a deterministic signature scheme, so in theory the
assertion should not fail.

I believe that the RSA key that Wang Gang is using is not correct.
For instance, some of the CRT coefficients may not be matching the private
exponent.

When that happens, the blinding countermeasures will not cancel out and the
result of RSA operations will be random (in addition to being incorrect).

2014-03-12 6:55 GMT+01:00 Philip Horger &lt;<A HREF="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">campadrenalin at gmail.com</A>&gt;:

&gt;<i> I'm not the king of crypto, but if I recall correctly, some signature
</I>&gt;<i> standards (and I think PKCS1 is one of them) include a random salt in the
</I>&gt;<i> signature. This happens automatically, behind the scenes, on your behalf.
</I>&gt;<i> So two signatures can be of the same content, with the same key, and not be
</I>&gt;<i> equal - in fact, it's dramatically more likely than not! So you can't rely
</I>&gt;<i> on bit-for-bit equality of signatures.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Tue, Mar 11, 2014 at 8:22 PM, wanggang &lt;
</I>&gt;<i> <A HREF="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">wanggang at goldenapptechnology.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi pycrypto,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This may be a simple problem since I am a newbiee to crypto.
</I>&gt;&gt;<i> I am not sure why I got different result from
</I>&gt;&gt;<i> PKCS1_v1_5.new(RSA.construct(lst)).sign(SHA.new(a2b(m))) ,
</I>&gt;&gt;<i> I have mentioned the 'stateful' comment in API doc, but still can't fix
</I>&gt;&gt;<i> the code below.
</I>&gt;&gt;<i> besides I have used DES for a lot, &amp; never got stuck in such situation.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> if __name__ == &quot;__main__&quot;:
</I>&gt;&gt;<i>     t = (modulus, publicExponent, privateExponent, prime1, prime2,
</I>&gt;&gt;<i> coefficient)
</I>&gt;&gt;<i>     lst = [long(x,16) for x in t]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     k = '1234'
</I>&gt;&gt;<i>     e1 = RSA.construct(lst).encrypt(m, k)
</I>&gt;&gt;<i>     e2 = RSA.construct(lst).encrypt(m, k)
</I>&gt;&gt;<i>     assert e1 == e2 # passed
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     signature1 = PKCS1_v1_5.new(RSA.construct(lst)).sign(SHA.new(a2b(m)))
</I>&gt;&gt;<i>     print binascii.b2a_hex(signature1)
</I>&gt;&gt;<i>     signature2 = PKCS1_v1_5.new(RSA.construct(lst)).sign(SHA.new(a2b(m)))
</I>&gt;&gt;<i>     print binascii.b2a_hex(signature2)
</I>&gt;&gt;<i>     assert signature1==signature2 # why this assertion failed ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thank you in advance!
</I>&gt;&gt;<i> --------------
</I>&gt;&gt;<i>  Wang Gang
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> pycrypto mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">pycrypto at lists.dlitz.net</A>
</I>&gt;&gt;<i> <A HREF="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> pycrypto mailing list
</I>&gt;<i> <A HREF="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">pycrypto at lists.dlitz.net</A>
</I>&gt;<i> <A HREF="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dlitz.net/pipermail/pycrypto/attachments/20140312/2620fdef/attachment.html">http://lists.dlitz.net/pipermail/pycrypto/attachments/20140312/2620fdef/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000785.html">[pycrypto] Got different PKCS1_v1_5 signature result on the same message &amp; same rsa key pair
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#786">[ date ]</a>
              <a href="thread.html#786">[ thread ]</a>
              <a href="subject.html#786">[ subject ]</a>
              <a href="author.html#786">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto">More information about the pycrypto
mailing list</a><br>
</body></html>
