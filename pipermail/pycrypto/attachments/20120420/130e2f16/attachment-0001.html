<tt>
&lt;html&nbsp;xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:m=&quot;http://schemas.microsoft.com/office/2004/12/omml&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;&lt;head&gt;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;&lt;meta&nbsp;name=Generator&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;14&nbsp;(filtered&nbsp;medium)&quot;&gt;&lt;style&gt;&lt;!--<br>
/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Tahoma;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;11&nbsp;6&nbsp;4&nbsp;3&nbsp;5&nbsp;4&nbsp;4&nbsp;2&nbsp;4;}<br>
/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:12.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,&quot;serif&quot;;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:blue;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:purple;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
span.hoenzb<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-name:hoenzb;}<br>
span.EmailStyle18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal-reply;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:#1F497D;}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}<br>
@page&nbsp;WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{size:8.5in&nbsp;11.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:1.0in&nbsp;1.0in&nbsp;1.0in&nbsp;1.0in;}<br>
div.WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{page:WordSection1;}<br>
--&gt;&lt;/style&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapedefaults&nbsp;v:ext=&quot;edit&quot;&nbsp;spidmax=&quot;1026&quot;&nbsp;/&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapelayout&nbsp;v:ext=&quot;edit&quot;&gt;<br>
&lt;o:idmap&nbsp;v:ext=&quot;edit&quot;&nbsp;data=&quot;1&quot;&nbsp;/&gt;<br>
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body&nbsp;lang=EN-US&nbsp;link=blue&nbsp;vlink=purple&gt;&lt;div&nbsp;class=WordSection1&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;span&nbsp;style='font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D'&gt;I&nbsp;assume&nbsp;you&nbsp;meant&nbsp;in&nbsp;step&nbsp;4&nbsp;&#8220;encrypt&nbsp;the&nbsp;secret&nbsp;(but&nbsp;NOT&nbsp;the&nbsp;payload)&nbsp;with&nbsp;RSA&#8221;.&nbsp;&nbsp;Otherwise&nbsp;you&#8217;ve&nbsp;double-encrypted&nbsp;stuff&nbsp;and&nbsp;consumed&nbsp;vast&nbsp;quantities&nbsp;of&nbsp;time&nbsp;doing&nbsp;bulk&nbsp;encryption&nbsp;with&nbsp;RSA.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;span&nbsp;style='font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D'&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;span&nbsp;style='font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D'&gt;If&nbsp;so,&nbsp;you&nbsp;have&nbsp;recreated&nbsp;approximately&nbsp;what&nbsp;PGP&nbsp;does,&nbsp;because&nbsp;it&nbsp;too&nbsp;doesn&#8217;t&nbsp;rely&nbsp;on&nbsp;a&nbsp;real&nbsp;time&nbsp;session.&nbsp;&nbsp;You&nbsp;might&nbsp;take&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;PGP&nbsp;RFC&nbsp;for&nbsp;a&nbsp;detailed&nbsp;recipe&nbsp;to&nbsp;follow.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;span&nbsp;style='font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D'&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;span&nbsp;style='font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D'&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paul&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;span&nbsp;style='font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D'&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;b&gt;&lt;span&nbsp;style='font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;'&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style='font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;'&gt;&nbsp;pycrypto-bounces@lists.dlitz.net&nbsp;[mailto:pycrypto-bounces@lists.dlitz.net]&nbsp;&lt;b&gt;On&nbsp;Behalf&nbsp;Of&nbsp;&lt;/b&gt;Antonio&nbsp;Teixeira&lt;br&gt;&lt;b&gt;Sent:&lt;/b&gt;&nbsp;Friday,&nbsp;April&nbsp;20,&nbsp;2012&nbsp;12:49&nbsp;PM&lt;br&gt;&lt;b&gt;To:&lt;/b&gt;&nbsp;PyCrypto&nbsp;discussion&nbsp;list&lt;br&gt;&lt;b&gt;Subject:&lt;/b&gt;&nbsp;Re:&nbsp;[pycrypto]&nbsp;RSA&nbsp;/&nbsp;OAEP&nbsp;-&nbsp;ValueError:&nbsp;Plaintext&nbsp;is&nbsp;too&nbsp;long.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-bottom:12.0pt'&gt;Hello&nbsp;Legrandin&nbsp;&amp;&nbsp;Others.&lt;br&gt;&lt;br&gt;I'm&nbsp;currently&nbsp;trying&nbsp;to&nbsp;implement&nbsp;the&nbsp;following&nbsp;:&lt;br&gt;&lt;br&gt;The&nbsp;&quot;proper&quot;&nbsp;way&nbsp;to&nbsp;do&nbsp;encryption&nbsp;would&nbsp;be&nbsp;to&nbsp;create&nbsp;a&nbsp;random&nbsp;AES&lt;br&gt;session&nbsp;key&nbsp;(16&nbsp;bytes),&nbsp;encrypt&nbsp;it&nbsp;with&nbsp;RSA&nbsp;(hopefully&nbsp;at&nbsp;least&nbsp;2048&lt;br&gt;bit&nbsp;long),&nbsp;send&nbsp;it,&nbsp;pad&nbsp;the&nbsp;data,&nbsp;encrypt&nbsp;it&nbsp;with&nbsp;AES,&nbsp;send&nbsp;it.&lt;br&gt;&lt;br&gt;Ok&nbsp;So&nbsp;..&nbsp;&lt;br&gt;&nbsp;-&nbsp;Create&nbsp;A&nbsp;Random&nbsp;AES&nbsp;16&nbsp;Bytes&nbsp;(&nbsp;I'm&nbsp;assuming&nbsp;this&nbsp;will&nbsp;be&nbsp;the&nbsp;&quot;secret&quot;)&lt;br&gt;-&nbsp;Pad&nbsp;The&nbsp;Payload&nbsp;&lt;br&gt;-&nbsp;Encrypt&nbsp;Using&nbsp;AES&lt;br&gt;-&nbsp;Encrypt&nbsp;The&nbsp;Secret&nbsp;+&nbsp;&nbsp;Payload&nbsp;With&nbsp;the&nbsp;RSA&nbsp;Key&lt;br&gt;-&nbsp;Make&nbsp;A&nbsp;Signature&nbsp;Of&nbsp;The&nbsp;Entire&nbsp;&quot;Encrypted&nbsp;Payload&quot;&lt;br&gt;-&nbsp;Append&nbsp;it&nbsp;to&nbsp;the&nbsp;&quot;Encrypted&nbsp;Payload&quot;&lt;br&gt;Send&nbsp;it&nbsp;....&lt;br&gt;&lt;br&gt;Recv&nbsp;it&nbsp;..&lt;br&gt;Make&nbsp;the&nbsp;reverse&nbsp;process.&lt;br&gt;&nbsp;&lt;br&gt;One&nbsp;thing&nbsp;i&nbsp;can't&nbsp;use&nbsp;the&nbsp;Normal&nbsp;SSL/TLS&nbsp;type&nbsp;of&nbsp;&quot;session&nbsp;key&quot;&nbsp;since&nbsp;there&nbsp;is&nbsp;no&nbsp;state&nbsp;across&nbsp;requests&nbsp;or&nbsp;during&nbsp;the&nbsp;handshake.&lt;br&gt;Meaning&nbsp;&quot;one&nbsp;worker&nbsp;can&nbsp;receive&nbsp;the&nbsp;request&nbsp;but&nbsp;another&nbsp;one&nbsp;can&nbsp;answer&nbsp;it&nbsp;and&nbsp;there&nbsp;is&nbsp;no&nbsp;shared&nbsp;memory&nbsp;between&nbsp;the&nbsp;two.&quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;div&gt;&lt;p&nbsp;class=MsoNormal&gt;2012/4/12&nbsp;Antonio&nbsp;Teixeira&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:eagle.antonio@gmail.com&quot;&gt;eagle.antonio@gmail.com&lt;/a&gt;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;Legrandin&nbsp;thank&nbsp;you&nbsp;for&nbsp;your&nbsp;help.&lt;br&gt;When&nbsp;i&nbsp;have&nbsp;time&nbsp;i&nbsp;will&nbsp;put&nbsp;something&nbsp;on&nbsp;pastebin&nbsp;so&nbsp;it&nbsp;can&nbsp;serve&nbsp;as&nbsp;example&nbsp;for&nbsp;future&nbsp;members&nbsp;that&nbsp;require&nbsp;this&nbsp;type&nbsp;of&nbsp;solution&nbsp;:)&lt;br&gt;&lt;br&gt;Regards&lt;span&nbsp;style='color:#888888'&gt;&lt;br&gt;&lt;span&nbsp;class=hoenzb&gt;A/T&lt;/span&gt;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;div&gt;&lt;p&nbsp;class=MsoNormal&gt;2012/4/11&nbsp;Legrandin&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:gooksankoo@hoiptorrow.mailexpire.com&quot;&nbsp;target=&quot;_blank&quot;&gt;gooksankoo@hoiptorrow.mailexpire.com&lt;/a&gt;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;div&gt;&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-bottom:12.0pt'&gt;&gt;&nbsp;So&nbsp;after&nbsp;a&nbsp;small&nbsp;search&nbsp;i&nbsp;found&nbsp;out&nbsp;that&nbsp;if&nbsp;i&nbsp;increase&nbsp;the&nbsp;RSA&nbsp;Modulus&nbsp;i'm&lt;br&gt;&gt;&nbsp;able&nbsp;to&nbsp;encrypt&nbsp;larger&nbsp;number&nbsp;of&nbsp;bits&nbsp;(&nbsp;makes&nbsp;sense&nbsp;)&nbsp;&nbsp;but&nbsp;this&nbsp;feels&nbsp;dirty.&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;What&nbsp;do&nbsp;your&nbsp;guys&nbsp;recommend&nbsp;?&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;Breaking&nbsp;the&nbsp;data&nbsp;in&nbsp;chunks&nbsp;and&nbsp;encrypting&nbsp;part&nbsp;by&nbsp;part&nbsp;joining&nbsp;it&nbsp;all&nbsp;in&nbsp;a&lt;br&gt;&gt;&nbsp;buffer&nbsp;and&nbsp;send&nbsp;it&nbsp;down&nbsp;the&nbsp;socket&nbsp;all&nbsp;in&nbsp;one&nbsp;with&nbsp;the&nbsp;other&nbsp;server&lt;br&gt;&gt;&nbsp;decrypting&nbsp;part&nbsp;by&nbsp;part&nbsp;and&nbsp;merging&nbsp;the&nbsp;data&nbsp;again&nbsp;?&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;P.S&nbsp;-&nbsp;I&nbsp;dont&nbsp;mind&nbsp;fishing&nbsp;by&nbsp;myself&nbsp;just&nbsp;trying&nbsp;to&nbsp;understand&nbsp;the&nbsp;best&nbsp;&quot;way&lt;br&gt;&gt;&nbsp;/&nbsp;more&nbsp;correct&nbsp;way&nbsp;&quot;&nbsp;to&nbsp;do&nbsp;it&nbsp;:)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&nbsp;class=MsoNormal&gt;Hi&nbsp;Antonio,&lt;br&gt;&lt;br&gt;Increasing&nbsp;the&nbsp;RSA&nbsp;key&nbsp;length&nbsp;is&nbsp;not&nbsp;&quot;dirty&quot;:&nbsp;it&nbsp;simply&nbsp;increases&lt;br&gt;security&nbsp;(and&nbsp;incidentally&nbsp;useful&nbsp;payload&nbsp;size)&nbsp;at&nbsp;the&nbsp;expense&nbsp;of&lt;br&gt;decryption&nbsp;speed.&lt;br&gt;If&nbsp;decryption&nbsp;speed&nbsp;is&nbsp;not&nbsp;that&nbsp;important&nbsp;to&nbsp;you,&nbsp;and&nbsp;you&nbsp;have&nbsp;a&nbsp;clear&lt;br&gt;idea&nbsp;on&nbsp;how&nbsp;long&nbsp;you&nbsp;data&nbsp;can&nbsp;be&nbsp;at&nbsp;most,&nbsp;go&nbsp;ahead&nbsp;and&nbsp;increase&nbsp;the&lt;br&gt;key&nbsp;size.&nbsp;The&nbsp;time&nbsp;you&nbsp;gain&nbsp;by&nbsp;taking&nbsp;this&nbsp;approach&nbsp;can&nbsp;be&nbsp;spent&nbsp;on&lt;br&gt;important&nbsp;tasks&nbsp;like&nbsp;making&nbsp;the&nbsp;private&nbsp;key&nbsp;secure,&nbsp;or&nbsp;adding&nbsp;some&lt;br&gt;form&nbsp;of&nbsp;authentication&nbsp;to&nbsp;your&nbsp;protocol.&lt;br&gt;&lt;br&gt;The&nbsp;&quot;proper&quot;&nbsp;way&nbsp;to&nbsp;do&nbsp;encryption&nbsp;would&nbsp;be&nbsp;to&nbsp;create&nbsp;a&nbsp;random&nbsp;AES&lt;br&gt;session&nbsp;key&nbsp;(16&nbsp;bytes),&nbsp;encrypt&nbsp;it&nbsp;with&nbsp;RSA&nbsp;(hopefully&nbsp;at&nbsp;least&nbsp;2048&lt;br&gt;bit&nbsp;long),&nbsp;send&nbsp;it,&nbsp;pad&nbsp;the&nbsp;data,&nbsp;encrypt&nbsp;it&nbsp;with&nbsp;AES,&nbsp;send&nbsp;it.&lt;br&gt;Additionally,&nbsp;you&nbsp;should&nbsp;also&nbsp;sign&nbsp;the&nbsp;data&nbsp;and&nbsp;send&nbsp;the&nbsp;signature&lt;br&gt;along.&lt;br&gt;&lt;br&gt;At&nbsp;the&nbsp;receiving&nbsp;end,&nbsp;you&nbsp;decrypt&nbsp;the&nbsp;session&nbsp;key&nbsp;with&nbsp;RSA,&nbsp;decrypt&lt;br&gt;the&nbsp;data&nbsp;with&nbsp;AES,&nbsp;unpad&nbsp;the&nbsp;data,&nbsp;and&nbsp;verify&nbsp;its&nbsp;signature.&lt;br&gt;_______________________________________________&lt;br&gt;pycrypto&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:pycrypto@lists.dlitz.net&quot;&nbsp;target=&quot;_blank&quot;&gt;pycrypto@lists.dlitz.net&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.dlitz.net/cgi-bin/mailman/listinfo/pycrypto&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
